<patient-history-menu></patient-history-menu>
<div class="page-content-wrapper">
    <div class="page-content">
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class=" patient-profile hr portlet padding-10 light bordered view-pro">
                    <div class="portlet-title">
                        <div class="col-md-1 col-sm-2 col-xs-12 no-padding">
                            <div class="profile-userpic"><img src="/public/images/patient.jpg" alt="patient.jpg" class="img-responsive"/></div>
                        </div>
                        <div class="col-md-10 col-sm-8 col-xs-12">
                            <div class="hr">
                                <h1 class="page-title no-margin"> {{patient.firstName }} {{""}}{{patient.lastName}}</h1>
                                <small class="small-txt">( {{patient.gender}} | {{patient.dob}})</small>
                            </div>
                            <div class="hr padding-b-10">
                                <div class="col-md-4 col-xs-12">
                                    <table width="100%" border="0">
                                        <tr>
                                            <td class="txt-rigt">Cell Phone:</td>
                                            <td class="txt-left font-red">{{patient.cellPhone}}</td>
                                            <!--<td class="font-red">Missing</td>-->
                                        </tr>
                                        <tr>
                                            <td class="txt-rigt">Address:</td>
                                            <td class="text-left font-red">{{patient.formattedAddress}}</td>
                                            <!--<td class="font-red">No address on file</td>-->
                                        </tr>
                                    </table>

                                </div>
                                <div class="col-md-4 col-xs-12">
                                    <table width="100%" border="0">
                                        <tr>
                                            <td class="txt-rigt">Email:</td>
                                            <td class="text-left font-red">{{patient.email}}</td>
                                            <!-- <td class="font-red">Missing</td>-->
                                        </tr>
                                        <tr>
                                            <td class="txt-rigt">Gender:</td>
                                            <td class="text-left font-red">{{patient.gender}}</td>
                                            <!-- <td class="font-red">Missing</td>-->
                                        </tr>
                                        <!--<tr>
                                            <td class="txt-rigt">Appt:</td>
                                            <td class="font-red">Mon. Jul. 27, 2015</td>
                                        </tr>-->
                                    </table>

                                </div>

                            </div>
                        </div>
                        <!--  <div class="col-md-1 col-sm-2 col-xs-12 text-right"> <span class="pull-right color-grey">{{patient.patientId}} </span> <span class="text-center"><img alt="barcode" title="barcode" class="img-responsive" src="/public/images/barcode.png"> </span> </div>-->
                    </div>
                    <div class="hr no-margin">
                        <div class="hr">
                            <div class="portlet-title">
                                <div class="caption"> <i class="icon-bar-chart font-dark hide"></i> <span class="caption-subject text-info bold">Primery Doctor:</span> <span class="caption-helper">{{patient.primaryDoctorFirstName+ ' ' + patient.primaryDoctorLastName}}</span> </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <form [formGroup]="labForm" class="form-horizontal">
                    <div class="hr mrgn-top8">
                        <div class="col-md-12 mrgn-btm10">
                            <h4 class="text-info">Enter Lab Orders</h4>
                        </div>


                        <div class="col-md-8">
                            <div class="form-group mrgn-btm08">
                                <label class="control-label col-md-3 pdng-lr-5"> Appointments <span
                                        class="required" aria-required="true"> * </span></label>
                                <!-- <label class="control-label txt-size pdng-lr-3">
                                     Appointments<span class="required" aria-required="true"> * </span>
                                 </label>-->

                                <div class="col-md-5 pdng-lr-5" *ngIf="!isUpdate">


                                    <p-dropdown  placeholder="select appointment"  [autoWidth]="false"  [style]="{'text-align': 'left' ,'width':'80%'}" name="apt"
                                                 (onChange) =selectedAppointment($event) [options]=" patient.pastAppointments" formControlName="appointmentId"  [panelStyle]="{minWidth:'12em'}" [filter]="true">
                                    </p-dropdown>
                                    <span class="text-danger"
                                          *ngIf="!labForm.controls['appointmentId'].valid && labForm.controls['appointmentId'].touched">
                                                    <span *ngIf="labForm.controls['appointmentId'].errors.required"> Please Select Appointment </span>
                                                </span>
                                </div>


                                <div class="col-md-5 pdng-lr-5" *ngIf="isUpdate">
                                    <p-dropdown   [autoWidth]="false"  [style]="{'text-align': 'left' ,'width':'80%'}" name="apt"
                                                  (onChange) =selectedAppointment($event) [options]=" patient.pastAppointments" formControlName="appointmentId"  [panelStyle]="{minWidth:'12em'}" [filter]="true" disabled="appointmentId">
                                    </p-dropdown>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-8" *ngIf="showDoctor">
                            <div class="form-group mrgn-btm08">
                                <label class="control-label col-md-3 pdng-lr-5"> Doctor </label>
                                <!-- <label class="control-label txt-size pdng-lr-3">
                                     Appointments<span class="required" aria-required="true"> * </span>
                                 </label>-->
                                <div class="col-md-5 pdng-lr-5">


                                    <input type="text"  class="form-control" formControlName="doctorName" value="{{doctorAppointment}}"  disabled>


                                </div>
                            </div>
                        </div>

                        <div class="col-md-8">
                            <div class="form-group mrgn-btm08">
                                <label class="control-label col-md-3 pdng-lr-5"> Status <span
                                        class="required" aria-required="true"> * </span></label>
                                <div class="col-md-5 pdng-lr-5">

                                    <p-dropdown  placeholder="Select Status" [autoWidth]="false"  [style]="{'text-align': 'left' ,'width':'100%'}" (onChange)="goToStatus($event)" name="pStatus"
                                                 formControlName="orderStatus" [options]="statusType"   [panelStyle]="{minWidth:'12em'}" [filter]="true">
                                    </p-dropdown>
                                    <span class="text-danger"
                                          *ngIf="!labForm.controls['orderStatus'].valid && labForm.controls['orderStatus'].touched">
                                                    <span *ngIf="labForm.controls['orderStatus'].errors.required"> Please Select Status </span>
                                                </span>
                                </div>
                                <div class="col-md-4 pdng-lr-5 font-siz">Status of the lab order.</div>
                            </div>
                        </div>

                        <div class="col-md-8">
                            <div class="form-group mrgn-btm08">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">Test Date:</label>

                                <div class="col-md-5 select pdng-lr-5">
                                    <angular2-date-picker   name="TestDate"
                                                            id="TestDate" [settings]="settings" [(ngModel)]="dateTest" [ngModelOptions]="{standalone:true}"></angular2-date-picker>
                                </div>
                            </div>
                        </div>


                        <div class="col-md-8">
                            <div class="form-group mrgn-btm08">
                                <label class="control-label col-md-3 pdng-lr-5">Comments</label>
                                <div class="col-md-5 pdng-lr-5">
                                    <textarea class="form-control" formControlName="comments"  style=""></textarea>
                                </div>
                                <div class="col-md-4 pdng-lr-5 font-siz">Status of the lab order.</div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="form-group mrgn-btm08">
                                <label class="control-label col-md-3 pdng-lr-5">Test<span
                                        class="required" aria-required="true"> * </span></label>
                                <div class="col-md-5 pdng-lr-5" *ngIf="!isUpdate">
                                    <!--<p-autoComplete  id="search" placeholder={{selectedString}} [suggestions]="filteredTestSingle" formControlName="testNameId"
                                                     (completeMethod)="filterLabTestSingle($event)" (completeMethod)="search($event)"
                                                     field="testCode" placeholder="Search Tests..." [dropdown]="true" ></p-autoComplete>-->
                                    <p-dropdown  placeholder="{{selectedTestNew}}" [autoWidth]="false" [(ngModel)]="selectedTestNew"
                                                 [style]="{'text-align': 'left' ,'width':'100%'}"
                                                 (onChange)="filterLabTestSingle($event.value)" formControlName="testNameId"  field="testCode"
                                                 [options]="searchedNamesLstNew"  [panelStyle]="{minWidth:'12em'}" [filter]="true" >
                                    </p-dropdown>
                                    <span class="text-danger"
                                          *ngIf="!labForm.controls['testNameId'].valid && labForm.controls['testNameId'].touched">
                                                    <span *ngIf="labForm.controls['testNameId'].errors.required"> Please Select Test </span>
                                    </span>
                                </div>
                                <div class="col-md-4 pdng-lr-5 font-siz">Test Name of the lab order.</div>
                                <div class="col-md-5" *ngIf="isUpdate">
                                    <!--<p-autoComplete   placeholder={{selectedString}} [suggestions]="filteredTestSingle"
                                                      formControlName="testNameId"
                                                      (completeMethod)="filterLabTestSingle($event)"
                                                      (completeMethod)="search($event)"
                                                      field="testCode" search
                                                      placeholder="Search Tests..." [dropdown]="true"
                                                      [disabled]="isUpdate"></p-autoComplete>-->

                                    <p-dropdown  placeholder="{{selectedTestNew}}" [autoWidth]="false" [(ngModel)]="selectedTestNew"
                                                 [style]="{'text-align': 'left' ,'width':'100%'}"  formControlName="testNameId"  field="testCode"
                                                 (onChange)="filterLabTestSingle($event.value)"
                                                 [options]="searchedNamesLstNew"  [panelStyle]="{minWidth:''}" [filter]="true" disabled="true">
                                    </p-dropdown>

                                </div>


                            </div>

                        </div>

                    </div>

                    <!-- <div class="row">
                         <form id="LabForm" *ngIf="showEdit" [formGroup]="labForm" #form="ngForm">
                             <div class="col-md-12">

                                 <div class="hr padding round-bck table-responsive">
                                     <div class="col-md-12 table-responsive round-table table table-striped table-hover table-checkable dataTable no-footer" >

                                         <div class="col-md-2">Test Code</div>
                                         <div class="col-md-2">Tes Name</div>
                                         <div class="col-md-2">Result value</div>
                                         <div class="col-md-2">Units</div>
                                         <div class="col-md-2">Normal Range</div>
                                         <div class="col-md-2">Actions</div>
                                     </div>
                                     <div class="col-md-12">
                                         <div>

                                             <div class="col-md-2">
                                                 <input type="text" formControlName="textCode" class="form-control" value="{{selectedTest.testCode}}"  disabled> </div>
                                             <div class="col-md-2">
                                                 <input type="text" formControlName="testName" class="form-control" value="{{selectedTest.testName}}"  disabled> </div>

                                             <div class="col-md-2">

                                                 <input type="text" required id="resultValueIdEdit" name="resultValueEdit"   class="form-control" placeholder="Enter Value"
                                                        [(ngModel)]="resultValue"  >
                                             </div>

                                             <div class="col-md-2">
                                                 <input type="text" formControlName="unit" class="form-control" value="{{selectedTest.unit}}" disabled> </div>

                                             <div class="col-md-2">
                                                 <input type="text" formControlName="normalRange" class="form-control" value="{{selectedTest.minNormalRange +'-'+ selectedTest.minNormalRange }}" disabled> </div>
                                             &lt;!&ndash;  <td rowspan="1" colspan="1"> <button class="btn btn-default pdng-lr-5 btn-outline font-red" data-title="Sweet Alerts with Icons" (click)="deleteTest(i)"  data-message="Success Icon" data-type="success" data-allow-outside-click="true" data-confirm-button-class="btn-success"><i class="fa fa-remove"></i></button> </td>&ndash;&gt;
                                             <div class="col-md-2">
                                                 <i (click)="deleteTestEdit()" title="Remove" class="fa fa-close font-red"></i>
                                             </div>
                                         </div>
                                     </div>

                                 </div>

                             </div>

                         </form>
                     </div>-->
                    <!--<div class="row">
                        <form name="LabForm" *ngIf="!showEdit" [formGroup]="labForm"  #form="ngForm" >
                            <div class="col-md-12">

                                <div class="hr padding round-bck table-responsive">
                                    <div class="col-md-12 table-responsive round-table table table-striped table-hover table-checkable dataTable no-footer" >

                                        <div class="col-md-2">Test Code</div>
                                        <div class="col-md-2">Tes Name</div>
                                        <div class="col-md-2">Result value</div>
                                        <div class="col-md-2">Units</div>
                                        <div class="col-md-2">Normal Range</div>
                                        <div class="col-md-2">Actions</div>
                                    </div>
                                    <div class="col-md-12">
                                        <div>

                                            <div class="col-md-2">
                                                <input type="text" formControlName="textCode" class="form-control" value="{{singleTestSpeciman.testCode}}"  disabled> </div>
                                            <div class="col-md-2">
                                                <input type="text" formControlName="testName" class="form-control" value="{{singleTestSpeciman.testName}}"  disabled> </div>
                                            <div class="col-md-2">



                                                <input type="text" id="resultValueId" name="resultValue"  class="form-control" placeholder="eg 123.."
                                                       [(ngModel)]="resultValue"  >
                                            </div>

                                            <div class="col-md-2">
                                                <input type="text" formControlName="unit" class="form-control" value="{{singleTestSpeciman.unit}}" disabled> </div>

                                            <div class="col-md-2">
                                                <input type="text" formControlName="normalRange" class="form-control" value="{{singleTestSpeciman.minNormalRange}}" disabled> </div>
                                            &lt;!&ndash;  <td rowspan="1" colspan="1"> <button class="btn btn-default pdng-lr-5 btn-outline font-red" data-title="Sweet Alerts with Icons" (click)="deleteTest(i)"  data-message="Success Icon" data-type="success" data-allow-outside-click="true" data-confirm-button-class="btn-success"><i class="fa fa-remove"></i></button> </td>&ndash;&gt;
                                            <div class="col-md-2">
                                                <i (click)="deleteTest()" title="Remove" class="fa fa-close font-red"></i>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>

                        </form>
                    </div>-->

                    <!-- <div class="row">
                         <div class="col-md-12 mrgn-btm10">
                             <div class="pull-right">
                                 <div class="pull-right">

                                     <button *ngIf="!showEdit" class="btn btn-default btn-outline btn-sm" (click)="addLabtoGrid()"> Add Test </button>
                                     <button *ngIf="showEdit" class="btn btn-default btn-outline btn-sm" (click)="updateLabtoGrid()"> Update Test </button>

                                 </div>
                                 &lt;!&ndash;<button class="btn mt-sweetalert btn green-meadow" data-title="Sweet Alerts with Icons" data-message="Success Icon" data-type="success" data-allow-outside-click="true" data-confirm-button-class="btn-success" (click)="addMoreTest()"><i class="fa fa-plus"></i> Add another </button>&ndash;&gt;
                             </div>
                         </div>
                     </div>-->


                    <!--<div class="row">

                        <table class="table table-striped table-hover table-checkable dataTable no-footer" id="datatable_ajax" aria-describedby="datatable_ajax_info"
                               role="grid">
                            <thead>
                            &lt;!&ndash;<tr role="row" class="">
                                <th width="6%" class="sorting_disabled" rowspan="1" colspan="1"> Code </th>
                                <th width="12%" class="sorting_disabled text-align-center" rowspan="1" colspan="1"> Test Name </th>
                                <th width="4%" class="sorting_disabled text-align-center" rowspan="1" colspan="1"> Result value </th>
                                <th width="9%" class="sorting_disabled text-align-center" rowspan="1" colspan="1"> Units </th>
                                <th width="6%" class="sorting_disabled text-align-center" rowspan="1" colspan="1"> Min - Max Range  </th>
                                <th width="6%" class="sorting_disabled text-align-center" rowspan="1" colspan="1"> Action </th>
                            </tr>&ndash;&gt;
                            <tr role="row" class="filter" *ngFor="let lbRT of LabReadList;  let idx = index">

                                <td class="sorting_disabled" rowspan="1" colspan="1">{{lbRT.testCode}}</td>
                                <td rowspan="1" colspan="1" class="text-align-right">{{lbRT.testName}}</td>
                                <td rowspan="1" colspan="1" rowspan="1" colspan="1" >{{lbRT.resultValue }}
                                </td>

                                <td rowspan="1" colspan="1" class="text-align-right">{{lbRT.unit}}</td>
                                <td rowspan="1" colspan="1" class="text-align-right">{{lbRT.minNormalRange}}</td>

                                <td rowspan="1" colspan="1" class="text-align-right">
                                    <button  (click)="editLabtoGrid(lbRT.id)" class="btn btn-default btn-outline btn-sm"><i class="fa fa-pencil"></i></button>
                                    <button  (click)="removeLabtoGrid(lbRT.id)" class="btn btn-default btn-outline btn-sm"> <i class="fa fa-remove font-red"></i> </button>
                                </td>
                            </tr>

                            </thead>
                        </table>
                        &lt;!&ndash; <div class="col-md-12 mrgn-btm10">
                             <div [formGroupName]="i">
                                 &lt;!&ndash; <div class="col-md-3">
                                      &lt;!&ndash;<input type="text" formControlName="loincCode" class="form-control" value="23">&ndash;&gt;
                                      <p-autoComplete formControlName="loincCode" [suggestions]="filteredTestSingle" (completeMethod)="filterLabTestSingle($event)" field="testCode" placeholder="Search Tests..." [dropdown]="true"></p-autoComplete>
                                  </div>&ndash;&gt;
                                 &lt;!&ndash; <td rowspan="1" colspan="1"> 11293-8: Type of Referral source </td>&ndash;&gt;
                                 <div class="col-md-2">
                                     <input type="text" formControlName="description" class="form-control" value="23" readonly>
                                 </div>
                                 <div class="col-md-2"> <input type="text" formControlName="units" class="form-control" value="23" readonly> </div>
                                 <div class="col-md-2"> <input type="text" formControlName="resultValue" class="form-control" value="45" readonly> </div>
                                 <div class="col-md-2"> <input type="text" formControlName="normalRange" class="form-control" value="100" readonly> </div>
                                 &lt;!&ndash;  <td rowspan="1" colspan="1"> <button class="btn btn-default pdng-lr-5 btn-outline font-red" data-title="Sweet Alerts with Icons" (click)="deleteTest(i)"  data-message="Success Icon" data-type="success" data-allow-outside-click="true" data-confirm-button-class="btn-success"><i class="fa fa-remove"></i></button> </td>&ndash;&gt;
                                 <div class="col-md-2">
                                     <i (click)="deleteTest(i)" title="" class="fa fa-pencil"></i>
                                     <i (click)="deleteTest(i)" title="Remove" class="fa fa-close font-red"></i>
                                 </div>
                             </div>
                         </div>&ndash;&gt;
                    </div>-->
                    <!--<div class="hr text-center bdr-top bdr-btm padding-b-10 padding-t-10">
                        <button class="btn blue" (click)="addLabOrder(labForm.value)"> Submit Order </button>
                    </div>-->
                    <div class="row">
                        <div class="col-md-12"  *ngIf="show">
                            <form name="invoiceForm">
                                <div class="hr padding round-bck table-responsive">
                                    <table class="table table-striped table-hover table-checkable dataTable no-footer" id="" aria-describedby="datatable_ajax_info"
                                           role="grid">
                                        <thead>
                                        <tr role="row" class="">
                                            <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Test Code </th>

                                            <!-- <th width="12%" class="sorting_disabled" rowspan="1" colspan="1"> Description </th> -->
                                            <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Result Value </th>
                                            <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Unit  </th>

                                            <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Range  </th>
                                            <th width="8%" class="sorting_disabled" rowspan="1" colspan="1"> Action</th>

                                        </tr>
                                        <tr role="row" class="filter">
                                            <td rowspan="1" colspan="1" class="custom-td-size">
                                                <input type="text" name="code" value="{{filterSpeciman.testCode}}"  disabled class="form-control" >
                                            </td>
                                            <!--<td class="sorting_disabled custom-td-size" rowspan="1" colspan="1">
                                                <input type="text" class="form-control" name="testname" value="{{filterSpeciman.testName}}"  disabled>
                                            </td>-->
                                            <!--   <td rowspan="1" colspan="1" class="custom-td-size">
                                                  <textarea type="text" name="description" value="{{selectedService.description}}" rows="1"></textarea>
                                              </td> -->
                                            <td rowspan="1" colspan="1" class="custom-td-size">
                                                <input type="text" id="resultValueId" name="resultValue"  class="form-control" placeholder="eg 123.."
                                                       [(ngModel)]="resultValue"  >

                                                <span class="text-danger">
                                                    <span *ngIf="isError"> Please Enter Value </span>
                                                </span>

                                            </td>
                                            <td rowspan="1" colspan="1" class="custom-td-size">
                                                <input type="text"  class="form-control" value="{{filterSpeciman.unit}}" disabled>
                                            </td>

                                            <td rowspan="1" colspan="1" class="custom-td-size">
                                                <!-- {{selectedTest.minNormalRange +'-'+ selectedTest.minNormalRange }} -->
                                                <input type="text"  class="form-control" value="{{filterSpeciman.minNormalRange}}" disabled>

                                            </td>
                                            <td rowspan="1" colspan="1" class="custom-td-size">
                                                <i (click)="clearField()" title="Remove" class="fa fa-close font-red"></i>
                                            </td>


                                        </tr>
                                        </thead>
                                    </table>
                                    <div class="pull-right">

                                        <button *ngIf="!showEdit" class="btn btn-default btn-outline btn-sm" (click)="addLabtoGrid()"> Add Test </button>
                                        <button *ngIf="showEdit" class="btn btn-default btn-outline btn-sm" (click)="updateLabtoGrid()"> Edit Test </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col-md-12">
                            <div class="table-scrollable">
                                <table class="table table-striped table-hover table-checkable dataTable no-footer" id="datatable_ajax" aria-describedby="datatable_ajax_info"
                                       role="grid">
                                    <thead>
                                    <tr role="row" class="off-wite-bg">
                                        <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Test Code </th>


                                        <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Result Value </th>
                                        <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Unit  </th>

                                        <th width="4%" class="sorting_disabled" rowspan="1" colspan="1"> Range  </th>
                                        <th width="8%" class="sorting_disabled" rowspan="1" colspan="1"> Action</th>
                                    </tr>
                                    <tr role="row" class="filter" *ngFor="let lbRT of LabReadList;  let idx = index">
                                        <!-- <td rowspan="1" colspan="1">{{lbRT.id}}</td>-->
                                        <td class="sorting_disabled" rowspan="1" colspan="1">{{lbRT.testCode}}</td>

                                        <td rowspan="1" colspan="1" class="text-align-left">{{lbRT.resultValue }}</td>
                                        <td rowspan="1" colspan="1" class="text-align-left">{{lbRT.unit}}</td>
                                        <td rowspan="1" colspan="1" class="text-align-left">{{lbRT.minNormalRange}}</td>

                                        <td rowspan="1" colspan="1" class="text-align-left">
                                            <button  (click)="editLabtoGrid(idx)" class="btn btn-default btn-outline btn-sm"><i class="fa fa-pencil"></i></button>
                                            <button  (click)="removeLabtoGrid(idx)" class="btn btn-default btn-outline btn-sm"> <i class="fa fa-remove font-red"></i> </button>
                                        </td>
                                    </tr>

                                    </thead>
                                </table>
                            </div>
                        </div>

                        <div class="col-md-4 mrgn-top8">

                        </div>


                        <div class="col-md-12 mrgn-top14">

                            <div class="pull-right">


                                <button class="btn blue" (click)="addLabOrder(labForm.value)"> Submit Order </button>

                            </div>
                        </div>
                    </div>

                </form>
            </div>
        </div>

    </div>
</div>
