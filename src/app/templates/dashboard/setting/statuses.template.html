<!--<patient-history-menu></patient-history-menu>-->
<div class="page-content-wrapper">
    <div class="page-content">

        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="hr">
                    <h4 class="text-info">Status
                        <div class="pull-right">
                            <a href="#statusModal" data-toggle="modal">
                                <button class="btn primary blue" (click)="addStatus()">
                                    <i class="fa fa-plus"></i> Add
                                </button>
                            </a>
                            <button class="btn green-meadow"
                                    data-title="Sweet Alerts with Icons" data-message="Success Icon"
                                    data-type="success" data-allow-outside-click="true"
                                    (click)="getAllStatusesFromServer(0)"
                                    data-confirm-button-class="btn-success"> Refresh
                            </button>
                            <span><button class="btn primary blue"> <i
                                    class=" icon-clock"></i> Print </button></span>
                        </div>
                    </h4>
                </div>
                    <!--<div class=" patient-profile hr portlet padding-10 light bordered view-pro">
                        <div class="col-md-4">
                            <div class="form-group font-siz11">
                                <input type="text" class="form-control"
                                       placeholder="Status Name"
                                       [(ngModel)]="searchStatus"
                                       (keydown.enter)="getAllStatusesFromServer(0)">
                            </div>
                        </div>
                        <div class="col-md-1">
                            <div class="form-group">
                                <button type="button" (click)="searchSatatusesFromServer()" class="btn blue">Search
                                </button>
                            </div>
                        </div>
                    </div>-->

                <div class="table-scrollable">
                    <p-table #dt [columns]="cols" [value]="data" [paginator]="true" [rows]="10">
                        <ng-template pTemplate="caption">
                            <div style="text-align: right">
                                <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                                <input type="text" pInputText size="50" placeholder="Name, Abbreviation" (input)="dt.filterGlobal($event.target.value, 'contains')" style="width:auto">
                            </div>
                        </ng-template>

                        <ng-template sortable="true" pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [pSortableColumn]="col.field" style='width: -webkit-fill-available;' [ngSwitch]="col.field">
                                    {{col.header}}
                                    <p-sortIcon *ngIf="col.field == 'name' || col.field == 'abbreviation'"
                                                [field]="col.field"
                                                ariaLabel="Sort"
                                                ariaLabelDesc="Sort in descending order"
                                                ariaLabelAsc="Sort in ascending order">
                                    </p-sortIcon>
                                </th>
                            </tr>
                            <!--<tr>
                                <th *ngFor="let col of columns" [ngSwitch]="col.field">
                                    <input *ngSwitchCase="'name'" pInputText type="text"  style="width: 100%" (input)="dt.filter($event.target.value, col.field, col.filterMatchMode)">
                                    <input *ngSwitchCase="'abbreviation'" pInputText type="text"  style="width: 100%" (input)="dt.filter($event.target.value, col.field, col.filterMatchMode)">
                                </th>
                            </tr>-->
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-data>
                            <tr>
                                <td field="name">{{data.name}}</td>
                                <td field="abbreviation">{{data.abbreviation}}</td>
                                <td field="colorHash"><input type="color" value="{{data.colorHash}}" disabled></td>
                                <!--<td field="active"><p-inputSwitch [(ngModel)]="data.active">{{data.active}}</p-inputSwitch></td>-->
                                <td><span
                                        [ngClass]="{'bg-green-meadow': data.active == true, 'bg-red-meadow': data.active ==false}"
                                        class="mt-action-dot">
                                       <!-- [ngClass]="{'bg-green-meadow': data.active == true, 'bg-red-meadow': data.active == false}"-->

                        </span></td>
                                <td field="action">
                                    <ng-container>
                                        <a href="#responsive" data-toggle="modal">
                                            <button class="" (click)="onUpdatePopupLoad(data)"> <i class="fa fa-pencil"></i> </button>
                                        </a>
                                        <span [hidden]="data.hasChild">

                                            <span *ngIf="data.systemStatus != true ">
                                            <button class="text-danger" (click)="deleteStatus(data.id)"> <i class="fa fa-remove"></i> </button>
                                            </span>
                                        </span>
                                    </ng-container>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                    <!--<table class="table table-striped table-hover table-checkable dataTable no-footer"
                           id="datatable_ajax" role="grid">
                        <thead>
                        <tr role="row" class="off-wite-bg">
                            <th width="20%" class="c-text-left padding"> Name</th>
                            <th width="50%"> Abbreviation</th>
                            <th width="8%"> Color</th>
                            <th width="8%"> Status</th>
                            <th width="16%"> Action</th>
                        </tr>
                        <tr *ngFor="let item of data; let i = index;" class="filter">
                            <td  class="c-text-left padding font-green-dark"><strong>{{item.name}}</strong></td>
                            <td  class="c-text-left">{{item.abbreviation}}</td>
                            <td  class="c-text-left" >
                                <input type="color" value="{{item.colorHash}}" disabled>
                            </td>
                            <td>
                                <p-inputSwitch  [(ngModel)]="item.active">{{item.active}}</p-inputSwitch>
                            </td>
                            <td class="sorting_disabled">
                                <a href="#responsive" data-toggle="modal">
                                    <button class="btn btn-default btn-outline btn-sm"
                                            (click)="onUpdatePopupLoad(item)"><i class="fa fa-pencil"></i>

                                    </button>
                                </a>
                                <span [hidden]="item.hasChild">
                                    <button class="btn btn-default btn-outline btn-sm"
                                            (click)="deleteStatus(item.id)">
                                        <i class="fa fa-remove"></i>
                                    </button>
                                </span>

                            </td>
                        </tr>
                        </thead>
                    </table>-->
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
        <!--<div class="row">
            <div class="col-md-12 col-xs-12 col-sm-12">
                <div class="dataTables_paginate paging_bootstrap_full_number pull-right" id="sample_1_2_paginate">
                    <ul class="pagination" style="visibility: visible;">
                        <li class="prev" *ngIf="pages.length >= 2 && currPage > 0">
                            <a (click)="getPageWiseDepartment(0);" title="First">
                                <i class="fa fa-angle-double-left"></i>
                            </a>
                        </li>
                        <li class="prev" *ngIf="prePage">
                            <a (click)="getPageWiseDepartment(currPage - 1)" title="Previous">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        </li>
                        <li [ngClass]="{active: page === currPage}"
                            *ngFor="let page of pages">
                            <a (click)="getPageWiseDepartment(page)">{{page + 1}}</a>
                        </li>
                        <li class="next" *ngIf="nextPage">
                            <a (click)="getPageWiseDepartment(currPage + 1)" title="Next">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
                        <li class="next" *ngIf="pages.length >= 2 && currPage < pages[pages.length - 1]">
                            <a (click)="getPageWiseDepartment(pages.length - 1)" title="Last">
                                <i class="fa fa-angle-double-right"></i>
                            </a>
                        </li>
                    </ul>
                </div>
                <p></p>
            </div>
        </div>-->
    </div>
</div>



<!-- Pop-up Modal-->

<div id="statusModal" bsModal #statusModal="bs-modal"   class="modal fade" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <form id="statusForm" class="status-form" #form="ngForm">
            <div class="modal-content" style="width: 80%">
                <div class="modal-header">
                    <button type="button" id="stClose" class="close" (click)="closeAddStatusModal()" data-dismiss="modal" aria-label="false"></button>
                    <h4 class="modal-title">Add Status</h4>
                </div>
                <div class="modal-body">
                    <div class="slimScrollDiv"
                         style="position: relative; overflow: hidden; width: auto;">
                        <div class="scroller" style="overflow: hidden; width: auto; height: 180px">
                            <div class="row">
                                <div class="form-group hr mrgn-btm08">
                                    <label class="col-md-3 control-label txt-size pdng-lr-5">Name <span
                                            class="required" aria-required="true"> * </span></label>
                                    <div class="col-md-9 select pdng-lr-5 profile-frm">
                                        <input class="form-control" type="text" required  [disabled]="changeStatusName"
                                               [(ngModel)]="status.name"  placeholder="name e.g under process or confirmed"
                                               required pattern="^[a-zA-Z 0-9_-]{1,60}$"
                                               name="stName" #stName="ngModel"/>
                                        <span *ngIf="stName.invalid && stName.touched"
                                              class="col-md-9 select pdng-lr-5 text-danger font-siz">
                                                Please enter valid name.
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group hr mrgn-btm08">
                                    <label class="col-md-3 control-label txt-size pdng-lr-5">Abbreviation
                                        </label>

                                        <div class="col-md-9 profile-frm select pdng-lr-5">
                                            <input class="form-control"  placeholder="abbreviation e.g short name "
                                                      type="text" [(ngModel)]="status.abbreviation"
                                                      name="abbrevation" #abbrevation="ngModel"/>
                                        </div>
                                </div>
                                <div class="form-group hr mrgn-btm08">
                                    <label class="col-md-3 control-label txt-size pdng-lr-5">Color
                                      </label>
                                    <div class="col-md-9 select pdng-lr-5 profile-frm">
                                        <input class="form-control" [(colorPicker)]="color" [value]="color"
                                               [ngModelOptions]="{standalone:true}"
                                               [style.background]="color"  placeholder="e.g color red ,blue"
                                               (keyup)="refresh.next()" [(ngModel)]="status.colorHash"/>
                                    </div>

                                </div>
                                <div class="form-group hr mrgn-btm08" *ngIf="status.id >0">
                                    <label class="col-md-3 pdng-lr-5 control-label txt-size">Status</label>
                                    <div class="col-md-3 select pdng-lr-5">
                                        <label class="mt-checkbox mt-checkbox-outline chckbox">
                                            <input type="checkbox"
                                                   class="form-control"
                                                   [(ngModel)]="status.active"
                                                   name="active"
                                                   #active="ngModel"><span></span></label>
                                    </div>
                                </div>


                                <!--<div class="form-group hr">
                                    <label class="col-md-3 pdng-lr-5 control-label txt-size">System Default</label>
                                    <div class="col-md-3 select pdng-lr-5">
                                        <label class="mt-checkbox mt-checkbox-outline chckbox">
                                            <input type="checkbox"
                                                   class="form-control"
                                                   [(ngModel)]="status.systemStatus"
                                                   name="defaultStatus"
                                                   #defaultStatus="ngModel"><span></span></label>
                                    </div>
                                </div>-->

                            </div>
                        </div>
                        <div class="slimScrollBar"
                             style="background: rgb(187, 187, 187); width: 7px; position: absolute; top: 0px; opacity: 0.4; display: none; border-radius: 7px; z-index: 99; right: 1px; height: 190px;"></div>
                        <div class="slimScrollRail"
                             style="width: 7px; height: 100%; position: absolute; top: 0px; display: none; border-radius: 7px; background: rgb(234, 234, 234); opacity: 0.2; z-index: 90; right: 1px;"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal" id="closeButton" (click)="closeAddStatusModal()" class="btn btn-default btn-outline">
                        Close
                    </button>
                    <button type="button" class="btn blue"
                            *ngIf="status.id <= 0 || status.id == null"
                            (click)="saveStatus(form)">Save
                    </button>
                    <button type="button" class="btn blue" *ngIf="status.id > 0"
                            (click)="updateStatus(form)">Update
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>