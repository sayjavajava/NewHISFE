<div class="page-content-wrapper">
    <div class="page-content">
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="hr">
                    <h4 class="text-info">Service Tax
                        <div class="pull-right">
                            <a href="#taxPopup" data-toggle="modal">
                                <button class="btn mt-sweetalert btn green-meadow"
                                        (click)="onTaxPopupLoad()"><i class="fa fa-plus"></i> Tax
                                </button>
                            </a>
                            <button class="btn mt-sweetalert btn blue"
                                    data-confirm-button-class="btn-success"
                                    (click)="refreshTaxesTable()"> Refresh
                            </button>
                        </div>
                    </h4>
                </div>
                <ngx-loading [show]="loading"></ngx-loading>
                <div class="table-scrollable">
                    <p-table #dt [rows]="5" [value]="dataTaxes" [paginator]="true" [columns]="cols">zz
                        <ng-template pTemplate="caption">
                            <div style="text-align: right">
                                <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                                <input type="text" pInputText size="50" placeholder="Search here..."
                                       (input)="dt.filterGlobal($event.target.value, 'contains')"
                                       style="width:auto">
                            </div>
                        </ng-template>
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                    {{col.header}}
                                    <p-sortIcon
                                            [field]="col.field" ariaLabel="Activate to sort"
                                            ariaLabelDesc="Activate to sort in descending order"
                                            ariaLabelAsc="Activate to sort in ascending order">
                                    </p-sortIcon>
                                </th>
                            </tr>
                            <!--<tr>
                                <th *ngFor="let col of cols" [ngSwitch]="col.field">
                                    <input *ngSwitchCase="'name'" pInputText type="text" style="width: 100%"
                                           (input)="dt.filter($event.target.value, col.field, col.filterMatchMode)">

                                    <input *ngSwitchCase="'rate'" pInputText type="text" style="width: 100%"
                                           (input)="dt.filter($event.target.value, col.field, col.filterMatchMode)">
                                </th>

                            </tr>-->
                        </ng-template>
                        <ng-template pTemplate="body" let-item>
                            <tr>
                                <td>{{item.name}}</td>
                                <td>
                                    {{item.rate | number :'.2-2'}}
                                </td>
                                <td>
                                    {{item.fromDate}}
                                </td>
                                <td>
                                    {{item.toDate}}
                                </td>
                                <td>{{item.description}}</td>
                                <td class="sorting_disabled" rowspan="1" colspan="1">
                                    {{item.active === true ? 'Active' : 'In-Active'}}
                                </td>
                                <td rowspan="1" colspan="1">
                                    <a href="#taxPopup" data-toggle="modal">
                                        <button class="font-blue"
                                                (click)="editServiceTax(item)">
                                            <i class="fa fa-pencil"></i>
                                        </button>
                                    </a>
                                    <span [hidden]="item.hasChild">
                                        <button class="text-danger"
                                                (click)="deleteServiceTax(item.id)">
                                            <i class="fa fa-remove">
                                            </i>
                                        </button>
                                    </span>
                                </td>

                            </tr>
                        </ng-template>
                    </p-table>

                </div>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
</div>

<div id="taxPopup" class="modal fade" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <form id="saveServiceTaxForm" #form="ngForm">

            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title" [hidden]="isUpdateServiceTax">Add Tax</h4>
                    <h4 class="modal-title" [hidden]="!isUpdateServiceTax">Update Tax</h4>
                </div>
                <div class="modal-body">
                    <div class="scroller" style="height:320px" data-always-visible="1" data-rail-visible1="1">
                        <div class="row">
                            <div class="form-group hr mrgn-btm08">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">Name
                                    <span class="required" aria-required="true"> * </span>
                                </label>
                                <div class="col-md-9 select pdng-lr-5 profile-frm">
                                    <input type="text"
                                           class="form-control"
                                           [(ngModel)]="serviceTax.name" id="name"
                                           placeholder="Enter Name" name="name"
                                           pattern="^[a-zA-Z% 0-9_-]{0,60}$" required
                                           #name="ngModel">
                                    <span *ngIf="name.invalid && name.touched"
                                          class="col-md-9 select pdng-lr-5 text-danger">Please enter valid name.
                                    </span>
                                </div>
                            </div>
                            <div class="form-group hr mrgn-btm08">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">Rate(%)
                                    <span class="required" aria-required="true"> * </span>
                                </label>
                                <div class="col-md-9 select pdng-lr-5 profile-frm">
                                    <input type="number"
                                           class="form-control"
                                           pattern="^\d+(\.\d{1,3})?$"
                                           [(ngModel)]="serviceTax.rate"
                                           disabled="{{isUpdateServiceTax}}"
                                           placeholder="Enter rate" name="rate"
                                           max="100" min="0" step="0.01"
                                           required id="rate"
                                           #rate="ngModel">
                                    <span *ngIf="rate.invalid && rate.touched || rate.value>100"
                                          class="text-danger">
                                        Please enter valid rate.
                                </span>
                                </div>

                            </div>
                            <div class="form-group hr mrgn-btm08">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">From
                                    <span class="required" aria-required="true"> * </span>
                                </label>
                                <div class="col-md-9 select pdng-lr-5 profile-frm">
                                    <input type="date" class="form-control form-control-inline input-medium"
                                           [(ngModel)]="serviceTax.fromDate" id="fromDate"
                                           (ngModelChange)="serviceTax.fromDate = $event" required
                                           name="fromDate" #fromDate="ngModel">
                                    <span *ngIf="fromDate.invalid && fromDate.touched"
                                           class="text-danger">
                                        Please enter valid from Date.
                                </span>
                                </div>

                            </div>
                            <div class="form-group hr mrgn-btm08">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">To
                                    <span class="required" aria-required="true"> * </span>
                                </label>
                                <div class="col-md-9 select pdng-lr-5 profile-frm">
                                    <input type="date" class="form-control form-control-inline input-medium"
                                           [(ngModel)]="serviceTax.toDate" id="toDate" required
                                           (ngModelChange)="serviceTax.toDate = $event"
                                           name="toDate" #toDate="ngModel">
                                    <span *ngIf="toDate.invalid && toDate.touched"
                                           class="text-danger">
                                        Please enter valid to Date.
                                </span>
                                </div>

                            </div>
                            <div class="form-group hr mrgn-btm08">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">Description
                                    <span class="required" aria-required="true">  </span>
                                </label>
                                <div class="col-md-9 select pdng-lr-5">
                                    <textarea rows="3"
                                              [(ngModel)]="serviceTax.description"
                                              maxlength="300"
                                              name="description"
                                              class="form-control"
                                              placeholder="Enter Description">
                                    </textarea>
                                </div>
                            </div>

                            <div class="form-group hr">
                                <label class="col-md-3 control-label txt-size pdng-lr-5">Status</label>
                                <div class="col-md-9 select pdng-lr-5 mt-checkbox mt-checkbox-outline">
                                    <!--<label class="mt-checkbox mt-checkbox-outline">
                                        <input type="checkbox" [(ngModel)]="serviceTax.active" name="active">
                                        <span></span>
                                    </label>-->
                                    <label class="mt-checkbox-outline">
                                        <mat-checkbox #status="ngModel"
                                                      name="active"
                                                      [(ngModel)]="serviceTax.active"
                                                      color="primary"></mat-checkbox>

                                    </label>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal" id="close-btn"
                            class="btn btn-default btn-outline">Close
                    </button>
                    <span [hidden]="isUpdateServiceTax">
                        <button type="button" class="btn blue" id="save-btn"
                                (click)="saveServiceTax(form)"
                                cl>Save
                        </button>
                    </span>
                    <span [hidden]="!isUpdateServiceTax">
                        <button type="button" class="btn blue" id="update-btn"
                                (click)="updateServiceTax(form)">Update
                        </button>
                    </span>

                </div>
            </div>
        </form>
    </div>
</div>
